pr:
  branches:
    include:
     - "*"

trigger:
  branches:
    exclude:
    - "*"

jobs:
- job: build
  displayName: Build
  pool:
    vmImage: 'ubuntu-latest'
  steps:
  - bash: cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=On .
  - bash: make -j8

- job: pvs_studio_analyze
  displayName: PVS-Studio Analyze
  pool:
    vmImage: 'ubuntu-latest'
  steps:
  - task: DownloadPipelineArtifact@2
    inputs:
      artifactName: 'TestDate'
      targetPath: $(Build.SourcesDirectory)/testdate
  
  - bash: date > testdate
  
  - publish: $(System.DefaultWorkingDirectory)/testdate
    artifact: TestDate